"""Property ID constants from the MS-ONE specification.

Reference: MS-ONE Section 2.1.12 and Apache Tika OneNotePropertyEnum.
Each property ID is a 32-bit value where:
  - Bits 0-25: Property identifier
  - Bits 26-30: Property type
  - Bit 31: Reserved
"""

from enum import IntEnum


class PropertyType(IntEnum):
    """Property data types (bits 26-30 of PropertyID)."""

    NO_DATA = 0x01
    BOOL = 0x02
    ONE_BYTE = 0x03
    TWO_BYTES = 0x04
    FOUR_BYTES = 0x05
    EIGHT_BYTES = 0x06
    FOUR_BYTES_OF_LENGTH_FOLLOWED_BY_DATA = 0x07
    OBJECT_ID = 0x08
    ARRAY_OF_OBJECT_IDS = 0x09
    OBJECT_SPACE_ID = 0x0A
    ARRAY_OF_OBJECT_SPACE_IDS = 0x0B
    CONTEXT_ID = 0x0C
    ARRAY_OF_CONTEXT_IDS = 0x0D
    ARRAY_OF_PROPERTY_VALUES = 0x10


def property_type(prop_id: int) -> int:
    """Extract the type field from a property ID (bits 26-30)."""
    return (prop_id >> 26) & 0x1F


def property_index(prop_id: int) -> int:
    """Extract the property index from a property ID (bits 0-25)."""
    return prop_id & 0x03FFFFFF


# --- Layout & Page Properties ---
LAYOUT_TIGHT_LAYOUT = 0x08001C00
PAGE_WIDTH = 0x14001C01
PAGE_HEIGHT = 0x14001C02
OUTLINE_ELEMENT_CHILD_LEVEL = 0x0C001C03

# --- Text Formatting ---
BOLD = 0x08001C04
ITALIC = 0x08001C05
UNDERLINE = 0x08001C06
STRIKETHROUGH = 0x08001C07
SUPERSCRIPT = 0x08001C08
SUBSCRIPT = 0x08001C09
FONT = 0x1C001C0A
FONT_SIZE = 0x10001C0B
FONT_COLOR = 0x14001C0C
HIGHLIGHT = 0x14001C0D

# --- Paragraph & Layout ---
RG_OUTLINE_INDENT_DISTANCE = 0x1C001C12
BODY_TEXT_ALIGNMENT = 0x0C001C13
OFFSET_FROM_PARENT_HORIZ = 0x14001C14
OFFSET_FROM_PARENT_VERT = 0x14001C15
NUMBER_LIST_FORMAT = 0x1C001C1A
LAYOUT_MAX_WIDTH = 0x14001C1B
LAYOUT_MAX_HEIGHT = 0x14001C1C

# --- Child Node References ---
CONTENT_CHILD_NODES = 0x24001C1F
ELEMENT_CHILD_NODES = 0x24001C20

# --- Text Content ---
RICH_EDIT_TEXT_UNICODE = 0x1C001C22
LIST_NODES = 0x24001C26

# --- Misc ---
NOTEBOOK_MANAGEMENT_ENTITY_GUID = 0x1C001C30
OUTLINE_ELEMENT_RTL = 0x08001C34
LANGUAGE_ID = 0x14001C3B
LAYOUT_ALIGNMENT_IN_PARENT = 0x14001C3E
PICTURE_CONTAINER = 0x20001C3F

# --- Page Margins ---
PAGE_MARGIN_TOP = 0x14001C4C
PAGE_MARGIN_BOTTOM = 0x14001C4D
PAGE_MARGIN_LEFT = 0x14001C4E
PAGE_MARGIN_RIGHT = 0x14001C4F

# --- List Font ---
LIST_FONT = 0x1C001C52

# --- Timestamps ---
TOPOLOGY_CREATION_TIMESTAMP = 0x18001C65

# --- Layout ---
LAYOUT_ALIGNMENT_SELF = 0x14001C84
IS_TITLE_TIME = 0x08001C87
IS_BOILER_TEXT = 0x08001C88
PAGE_SIZE = 0x14001C8B
PORTRAIT_PAGE = 0x08001C8E

# --- Ordering ---
NOTEBOOK_ELEMENT_ORDERING_ID = 0x14001CB9
IS_TITLE_TEXT = 0x08001CB4
IS_TITLE_DATE = 0x08001CB5
LIST_RESTART = 0x14001CB7

# --- Cached Title ---
CACHED_TITLE_STRING = 0x1C001CF3

# --- Rich Edit Lang ---
RICH_EDIT_TEXT_LANG_ID = 0x10001CFE
CHARSET = 0x0C001D01

# --- Creation & Modification ---
CREATION_TIMESTAMP = 0x14001D09
DELETABLE = 0x08001D0C

# --- Cached Title From Page ---
CACHED_TITLE_STRING_FROM_PAGE = 0x1C001D3C

# --- Table Properties ---
ROW_COUNT = 0x14001D57
COLUMN_COUNT = 0x14001D58
TABLE_BORDERS_VISIBLE = 0x08001D5E
STRUCTURE_ELEMENT_CHILD_NODES = 0x24001D5F
TABLE_COLUMN_WIDTHS = 0x1C001D66

# --- Author & Timestamp ---
AUTHOR = 0x1C001D75
LAST_MODIFIED_TIMESTAMP = 0x18001D77
AUTHOR_ORIGINAL = 0x20001D78
AUTHOR_MOST_RECENT = 0x20001D79
LAST_MODIFIED_TIME = 0x14001D7A

# --- Conflict ---
IS_CONFLICT_PAGE = 0x08001D7C
TABLE_COLUMNS_LOCKED = 0x1C001D7D

# --- Embedded Files ---
EMBEDDED_FILE_CONTAINER = 0x20001D9B
EMBEDDED_FILE_NAME = 0x1C001D9C
SOURCE_FILEPATH = 0x1C001D9D

# --- Image ---
IMAGE_FILENAME = 0x1C001DD7
PAGE_LEVEL = 0x14001DFF

# --- Hyperlink ---
TEXT_RUN_INDEX = 0x1C001E12
TEXT_RUN_FORMATTING = 0x24001E13
HYPERLINK = 0x08001E14
UNDERLINE_TYPE = 0x0C001E15
HIDDEN = 0x08001E16
HYPERLINK_PROTECTED = 0x08001E19
WZ_HYPERLINK_URL = 0x1C001E20
TEXT_RUN_IS_EMBEDDED_OBJECT = 0x08001E22
ENABLE_HISTORY = 0x08001E1E

# --- Image Alt ---
IMAGE_ALT_TEXT = 0x1C001E58

# --- Paragraph Style ---
PARAGRAPH_STYLE = 0x2000342C
PARAGRAPH_SPACE_BEFORE = 0x1400342E
PARAGRAPH_SPACE_AFTER = 0x1400342F

# --- Extended Text ---
TEXT_EXTENDED_ASCII = 0x1C003498
PARAGRAPH_STYLE_ID = 0x1C00345A

# --- Note Tags ---
NOTE_TAG_SHAPE = 0x10003464
NOTE_TAG_HIGHLIGHT_COLOR = 0x14003465
NOTE_TAG_TEXT_COLOR = 0x14003466
NOTE_TAG_LABEL = 0x1C003468
NOTE_TAG_CREATED = 0x1400346E
NOTE_TAG_COMPLETED = 0x1400346F

# --- Section ---
SECTION_DISPLAY_NAME = 0x1C00349B

# --- Picture Dimensions ---
PICTURE_WIDTH = 0x140034CD
PICTURE_HEIGHT = 0x140034CE

# --- Text Run Data ---
TEXT_RUN_DATA_OBJECT = 0x24003458
TEXT_RUN_DATA = 0x40003499

# --- Web Picture ---
WEB_PICTURE_CONTAINER_14 = 0x200034C8


# JCID (object type) constants from MS-ONE Section 2.1.13
class JCIDType(IntEnum):
    """Object type identifiers."""

    READ_ONLY_PERSISTABLE_PROPERTY_CONTAINER_FOR_AUTHOR = 0x00120001
    PERSISTABLE_PROPERTY_CONTAINER_FOR_TOC = 0x00020001
    SECTION_NODE = 0x00060007
    PAGE_SERIES_NODE = 0x00060008
    PAGE_NODE = 0x0006000B
    OUTLINE_NODE = 0x0006000C
    OUTLINE_ELEMENT_NODE = 0x0006000D
    RICH_TEXT_OE_NODE = 0x0006000E
    IMAGE_NODE = 0x00060011
    NUMBER_LIST_NODE = 0x00060012
    OUTLINE_GROUP = 0x00060019
    TABLE_NODE = 0x00060022
    TABLE_ROW_NODE = 0x00060023
    TABLE_CELL_NODE = 0x00060024
    TITLE_NODE = 0x0006002C
    PAGE_META_DATA = 0x00020030
    SECTION_META_DATA = 0x00020031
    EMBEDDED_FILE_NODE = 0x00060035
    PAGE_MANIFEST_NODE = 0x00060037
    CONFLICT_PAGE_META_DATA = 0x00020038
    VERSION_HISTORY_CONTENT = 0x0006003C
    VERSION_PROXY = 0x0006003D
    NOTE_TAG_SHARED_DEFINITION_CONTAINER = 0x00120043
    REVISION_META_DATA = 0x00020044
    VERSION_HISTORY_META_DATA = 0x00020046
    PARAGRAPH_STYLE_OBJECT = 0x0012004D


# Human-readable property name mapping
PROPERTY_NAMES: dict[int, str] = {
    BOLD: "Bold",
    ITALIC: "Italic",
    UNDERLINE: "Underline",
    STRIKETHROUGH: "Strikethrough",
    SUPERSCRIPT: "Superscript",
    SUBSCRIPT: "Subscript",
    FONT: "Font",
    FONT_SIZE: "FontSize",
    FONT_COLOR: "FontColor",
    HIGHLIGHT: "Highlight",
    RICH_EDIT_TEXT_UNICODE: "RichEditTextUnicode",
    TEXT_EXTENDED_ASCII: "TextExtendedAscii",
    CACHED_TITLE_STRING: "CachedTitleString",
    CACHED_TITLE_STRING_FROM_PAGE: "CachedTitleStringFromPage",
    PICTURE_CONTAINER: "PictureContainer",
    IMAGE_FILENAME: "ImageFilename",
    IMAGE_ALT_TEXT: "ImageAltText",
    ROW_COUNT: "RowCount",
    COLUMN_COUNT: "ColumnCount",
    TABLE_COLUMN_WIDTHS: "TableColumnWidths",
    TABLE_BORDERS_VISIBLE: "TableBordersVisible",
    WZ_HYPERLINK_URL: "WzHyperlinkUrl",
    HYPERLINK: "Hyperlink",
    AUTHOR: "Author",
    CREATION_TIMESTAMP: "CreationTimeStamp",
    LAST_MODIFIED_TIME: "LastModifiedTime",
    PAGE_LEVEL: "PageLevel",
    IS_TITLE_TEXT: "IsTitleText",
    IS_TITLE_DATE: "IsTitleDate",
    IS_TITLE_TIME: "IsTitleTime",
    OUTLINE_ELEMENT_CHILD_LEVEL: "OutlineElementChildLevel",
    CONTENT_CHILD_NODES: "ContentChildNodes",
    ELEMENT_CHILD_NODES: "ElementChildNodes",
    TEXT_RUN_INDEX: "TextRunIndex",
    TEXT_RUN_FORMATTING: "TextRunFormatting",
    EMBEDDED_FILE_CONTAINER: "EmbeddedFileContainer",
    EMBEDDED_FILE_NAME: "EmbeddedFileName",
    SOURCE_FILEPATH: "SourceFilepath",
    SECTION_DISPLAY_NAME: "SectionDisplayName",
    NUMBER_LIST_FORMAT: "NumberListFormat",
    BODY_TEXT_ALIGNMENT: "BodyTextAlignment",
    PAGE_WIDTH: "PageWidth",
    PAGE_HEIGHT: "PageHeight",
    NOTE_TAG_LABEL: "NoteTagLabel",
    PARAGRAPH_STYLE_ID: "ParagraphStyleId",
    LIST_FONT: "ListFont",
    PICTURE_WIDTH: "PictureWidth",
    PICTURE_HEIGHT: "PictureHeight",
}
